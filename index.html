<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <script src='https://d3js.org/d3.v5.min.js'></script>
		<script src="https://rawgit.com/susielu/d3-annotation/master/d3-annotation.min.js"></script>
        <link rel="stylesheet" type="text/css" href="css/main.css" />
    </head>
    
    <body onload='init()'>
        <h1>World Average Temperature From Mean (C), 1880-2020</h1>
        <div class="text-center">
            <button><</button>
            <button>1880-1920</button>
            <button>1921-1980</button>
            <button>1981-2020</button>
            <button>All Years</button>
            <button>></button>
        </div>
        <svg style="display: block; margin-left: auto; margin-right: auto; width: 600px; height: 600px"></svg>
        <script>
			// add a tooltip
			var tooltip = d3.select("body")
			.append("div")
			.style("opacity", 1)
			.attr("class", "tooltip")
			.style("background-color", "white")
			.style("border", "solid")
			.style("border-width", "1px")
			.style("border-radius", "5px")
			.style("padding", "10px")

			// mousover function
			var mouseover = function(d) {
			tooltip
			  .style("opacity", 1)
			}
			
			// mouse move function
			var mousemove = function(d) {
			tooltip
			  .html("Year: " + d.year)
			  .style("left", (d3.mouse(this)[0]+90) + "px")
			  .style("top", (d3.mouse(this)[1]) + "px")
			}

			// set tooltip opacity to 0 when mouse leaves
			var mouseleave = function(d) {
			tooltip
			  .transition()
			  .duration(200)
			  .style("opacity", 0)
			}
		
            async function init() {
                // Variables for the method
                width = 500;
                height = 500;
                margin = 50;
                cxs = d3.scaleLinear().domain([1880,2020]).range([0,width]);
                cys = d3.scaleLinear().domain([-2,2]).range([height,0]);
				
                // get data and wait for result  
                const data = await d3.csv("global_air_ocean_temp_deviation.csv");

                // Create an SVG to place scatterplot on for data
                // convert string to integer using '+' notation on the data element
                d3.select("svg")
                        .append("g")
                        .attr("transform", "translate("+margin+","+margin+")")
                        .selectAll().data(data).enter().append("circle")
                            .attr("cx", function(d) {return cxs(+d.year);})
                            .attr("cy", function(d) {return cys(+d.value);})
                            .attr("r", 7)
						.on("mouseover", mouseover)
						.on("mousemove", mousemove)
						.on("mouseleave", mouseleave);
				
				// HELOOOOOOOOOO
				// create y-axis
				d3.select("svg").append("g")
				  .attr("transform","translate("+margin+","+margin+")")
				  .call(d3.axisLeft(cys)
						  .tickValues([-1.5, -1, -.5, 0, .5, 1, 1.5])
						  .tickFormat(d3.format(".1f")));

				// create x-axis
				d3.select("svg").append("g")
				  .attr("transform","translate("+margin+","+(height+margin)+")")
				  .call(d3.axisBottom(cxs)
						  .tickValues([1880,1900,1920,1940,1960,1980,2000,2020])
						  .tickFormat(d3.format(".0f")));
				
            }
        </script>
    </body>
</html>
